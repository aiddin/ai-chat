{"version":3,"sources":["../src/components/ai-chat.ts"],"names":["AIChat","LitElement","html","repeat","classMap","unsafeHTML","css","state","customElement"],"mappings":"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AA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA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","file":"index.js","sourcesContent":["import { LitElement, html, css, PropertyValues } from 'lit';\r\nimport { customElement, state } from 'lit/decorators.js';\r\nimport { repeat } from 'lit/directives/repeat.js';\r\nimport { classMap } from 'lit/directives/class-map.js';\r\nimport { unsafeHTML } from 'lit/directives/unsafe-html.js';\r\n\r\nconst VERSION = '0.2.8';\r\n\r\n// FAQ functionality - commented out for now\r\n// export interface FAQ {\r\n//   \"no.\": string;\r\n//   question: string;\r\n// }\r\n\r\nexport interface Message {\r\n  id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  faqs?: any[];  // Commented out functionality - type changed to any[] to avoid FAQ interface dependency\r\n  suggestedQuestions?: string[];\r\n}\r\n\r\n/**\r\n * AI Chat Web Component\r\n *\r\n * @fires message-sent - Fired when user sends a message\r\n * @fires response-received - Fired when AI responds\r\n * @fires error - Fired when an error occurs\r\n *\r\n * @example\r\n * ```html\r\n * <!-- Basic usage -->\r\n * <ai-chat\r\n *   api-url=\"https://api.example.com\"\r\n *   session-id=\"user-123\"\r\n *   title=\"My AI Assistant\">\r\n * </ai-chat>\r\n *\r\n * <!-- Widget mode with custom size -->\r\n * <ai-chat\r\n *   api-url=\"https://api.example.com\"\r\n *   session-id=\"user-123\"\r\n *   title=\"My AI Assistant\"\r\n *   mode=\"widget\"\r\n *   widget-width=\"400px\"\r\n *   widget-height=\"650px\">\r\n * </ai-chat>\r\n *\r\n * <!-- Custom theme colors -->\r\n * <ai-chat\r\n *   api-url=\"https://api.example.com\"\r\n *   session-id=\"user-123\"\r\n *   title=\"My AI Assistant\"\r\n *   primary-color=\"#10B981\"\r\n *   primary-color-hover=\"#059669\"\r\n *   user-message-bg=\"#D1FAE5\"\r\n *   bot-message-bg=\"#F3F4F6\">\r\n * </ai-chat>\r\n * ```\r\n */\r\n@customElement('ai-chat')\r\nexport class AIChat extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      font-family: system-ui, -apple-system, sans-serif;\r\n      color: #09090b;\r\n    }\r\n\r\n    /* Fullscreen mode (default) */\r\n    :host([mode=\"fullscreen\"]) {\r\n      display: flex;\r\n      flex-direction: column;\r\n      height: 100vh;\r\n      background: #ffffff;\r\n    }\r\n\r\n    :host([mode=\"fullscreen\"][theme=\"dark\"]) {\r\n      background: #000;\r\n      color: #fafafa;\r\n    }\r\n\r\n    /* Widget mode */\r\n    :host([mode=\"widget\"]) {\r\n      position: fixed;\r\n      bottom: 20px;\r\n      right: 20px;\r\n      z-index: 9999;\r\n    }\r\n\r\n    .widget-container {\r\n      position: relative;\r\n    }\r\n\r\n    .widget-button {\r\n      width: 60px;\r\n      height: 60px;\r\n      border-radius: 50%;\r\n      background: #3681D3;\r\n      border: none;\r\n      cursor: pointer;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      box-shadow: 0 4px 16px rgba(65, 105, 225, 0.3);\r\n      transition: transform 0.2s, box-shadow 0.2s;\r\n    }\r\n\r\n    .widget-button:hover {\r\n      transform: scale(1.05);\r\n      box-shadow: 0 6px 20px rgba(65, 105, 225, 0.4);\r\n    }\r\n\r\n    .widget-button svg {\r\n      width: 28px;\r\n      height: 28px;\r\n      color: white;\r\n    }\r\n\r\n    .widget-window {\r\n      position: absolute;\r\n      bottom: 80px;\r\n      right: 0;\r\n      width: var(--widget-width, 380px);\r\n      height: var(--widget-height, 600px);\r\n      background: #fff;\r\n      border-radius: 16px;\r\n      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(0, 0, 0, 0.05);\r\n      display: flex;\r\n      flex-direction: column;\r\n      overflow: hidden;\r\n      opacity: 0;\r\n      transform: scale(0.9) translateY(20px);\r\n      pointer-events: none;\r\n      transition: opacity 0.2s, transform 0.2s;\r\n    }\r\n\r\n    .widget-window.open {\r\n      opacity: 1;\r\n      transform: scale(1) translateY(0);\r\n      pointer-events: all;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .widget-window {\r\n      background: #18181b;\r\n      color: #fafafa;\r\n    }\r\n\r\n    /* Tablet breakpoint */\r\n    @media (max-width: 1024px) and (min-width: 769px) {\r\n      .widget-window {\r\n        width: var(--widget-width, 400px);\r\n        height: var(--widget-height, 650px);\r\n      }\r\n    }\r\n\r\n    /* Small tablet breakpoint */\r\n    @media (max-width: 768px) and (min-width: 481px) {\r\n      .widget-window {\r\n        width: var(--widget-width, 360px);\r\n        height: var(--widget-height, 550px);\r\n      }\r\n    }\r\n\r\n    /* Mobile portrait */\r\n    @media (max-width: 480px) and (orientation: portrait) {\r\n      .widget-window {\r\n        width: calc(100vw - 40px);\r\n        height: 70vh;\r\n        bottom: 80px;\r\n        right: 0;\r\n      }\r\n\r\n      .widget-button {\r\n        width: 56px;\r\n        height: 56px;\r\n      }\r\n\r\n      .widget-button svg {\r\n        width: 24px;\r\n        height: 24px;\r\n      }\r\n    }\r\n\r\n    /* Mobile landscape */\r\n    @media (max-width: 900px) and (orientation: landscape) {\r\n      .widget-window {\r\n        width: var(--widget-width, 500px);\r\n        height: calc(100vh - 100px);\r\n        bottom: 80px;\r\n        right: 0;\r\n      }\r\n\r\n      .widget-button {\r\n        width: 56px;\r\n        height: 56px;\r\n      }\r\n\r\n      .widget-button svg {\r\n        width: 24px;\r\n        height: 24px;\r\n      }\r\n    }\r\n\r\n    /* Mobile responsive styles for all modes */\r\n    @media (max-width: 768px) {\r\n      .header {\r\n        padding: 0.875rem 1rem;\r\n      }\r\n\r\n      .header-avatar {\r\n        width: 2.25rem;\r\n        height: 2.25rem;\r\n      }\r\n\r\n      .title {\r\n        font-size: 1.125rem;\r\n      }\r\n\r\n      .messages-area {\r\n        padding: 1rem 0.75rem;\r\n      }\r\n\r\n      .message {\r\n        gap: 0.75rem;\r\n      }\r\n\r\n      .avatar {\r\n        width: 2rem;\r\n        height: 2rem;\r\n        font-size: 0.75rem;\r\n      }\r\n\r\n      .message-content {\r\n        max-width: 100%;\r\n        padding: 0.625rem 0.875rem;\r\n        font-size: 0.9375rem;\r\n      }\r\n\r\n      .empty-state {\r\n        margin-top: 3rem;\r\n      }\r\n\r\n      .empty-state p {\r\n        font-size: 1.25rem;\r\n        padding: 0 1rem;\r\n      }\r\n\r\n      .faq-section {\r\n        margin-top: 0.75rem;\r\n        padding-top: 0.75rem;\r\n      }\r\n\r\n      .faq-item {\r\n        font-size: 0.8125rem;\r\n        padding: 0;\r\n      }\r\n\r\n      .input-area {\r\n        padding: 0.75rem;\r\n      }\r\n\r\n      .input-form {\r\n        gap: 0.5rem;\r\n      }\r\n\r\n      .input-field {\r\n        height: 2.75rem;\r\n        padding: 0 0.875rem;\r\n        font-size: 0.9375rem;\r\n      }\r\n\r\n      .send-button {\r\n        width: 2.75rem;\r\n        height: 2.75rem;\r\n        flex-shrink: 0;\r\n      }\r\n\r\n      .send-icon {\r\n        width: 1.125rem;\r\n        height: 1.125rem;\r\n      }\r\n    }\r\n\r\n    /* Extra small screens */\r\n    @media (max-width: 480px) {\r\n      .header {\r\n        padding: 0.75rem 0.875rem;\r\n      }\r\n\r\n      .header-avatar {\r\n        width: 2rem;\r\n        height: 2rem;\r\n      }\r\n\r\n      .title {\r\n        font-size: 1rem;\r\n      }\r\n\r\n      .messages-area {\r\n        padding: 0.75rem 0.5rem;\r\n      }\r\n\r\n      .message {\r\n        gap: 0.5rem;\r\n      }\r\n\r\n      .avatar {\r\n        width: 1.75rem;\r\n        height: 1.75rem;\r\n        font-size: 0.7rem;\r\n      }\r\n\r\n      .message-content {\r\n        padding: 0.5rem 0.75rem;\r\n        font-size: 0.875rem;\r\n        border-radius: 0.75rem;\r\n      }\r\n\r\n      .empty-state {\r\n        margin-top: 2rem;\r\n      }\r\n\r\n      .empty-state p {\r\n        font-size: 1.125rem;\r\n      }\r\n\r\n      .input-area {\r\n        padding: 0.625rem;\r\n      }\r\n\r\n      .input-field {\r\n        height: 2.5rem;\r\n        padding: 0 0.75rem;\r\n        font-size: 0.875rem;\r\n      }\r\n\r\n      .send-button {\r\n        width: 2.5rem;\r\n        height: 2.5rem;\r\n      }\r\n\r\n      .version-tag {\r\n        font-size: 0.7rem;\r\n        padding: 0.375rem;\r\n      }\r\n    }\r\n\r\n    .header {\r\n      background:#3681D3;\r\n      padding: 1rem 1.25rem;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 0.75rem;\r\n      box-shadow: 0 2px 8px rgba(65, 105, 225, 0.2);\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .header {\r\n      background: #3681D3\r\n    }\r\n\r\n    .header-content {\r\n      max-width: 56rem;\r\n      margin: 0 auto;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 0.75rem;\r\n      width: 100%;\r\n    }\r\n\r\n    .header-avatar {\r\n      width: 2.5rem;\r\n      height: 2.5rem;\r\n      border-radius: 50%;\r\n      background: #fff;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      overflow: hidden;\r\n      flex-shrink: 0;\r\n    }\r\n\r\n    .header-avatar-image {\r\n      width: 100%;\r\n      height: 100%;\r\n      object-fit: cover;\r\n    }\r\n\r\n    .title {\r\n      font-size: 1.25rem;\r\n      font-weight: 600;\r\n      margin: 0;\r\n      color: #fff;\r\n    }\r\n\r\n    .messages-area {\r\n      flex: 1;\r\n      overflow-y: auto;\r\n      padding: 1.5rem 1rem;\r\n      position: relative;\r\n      background: #ffffff;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .messages-area {\r\n      background: #000;\r\n    }\r\n\r\n    .messages-area::before {\r\n      content: '';\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      bottom: 0;\r\n      background-image: var(--background-image-url);\r\n      background-size: 200px auto 60%;\r\n      background-position: center center;\r\n      background-repeat: no-repeat;\r\n      opacity: 0.03;\r\n      pointer-events: none;\r\n      z-index: 0;\r\n    }\r\n\r\n    .messages-container {\r\n      max-width: 56rem;\r\n      margin: 0 auto;\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 1.5rem;\r\n      position: relative;\r\n      z-index: 1;\r\n    }\r\n\r\n    .empty-state {\r\n      text-align: center;\r\n      margin-top: 5rem;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      gap: 1.5rem;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .empty-state {\r\n      color: #a1a1aa;\r\n    }\r\n\r\n    .empty-state-avatar {\r\n      width: 5rem;\r\n      height: 5rem;\r\n      border-radius: 50%;\r\n      background: #E5E7EB;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      overflow: hidden;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .empty-state-avatar {\r\n      background: #3f3f46;\r\n    }\r\n\r\n    .empty-state-avatar-image {\r\n      width: 100%;\r\n      height: 100%;\r\n      object-fit: cover;\r\n    }\r\n\r\n    .empty-state-avatar svg {\r\n      width: 3rem;\r\n      height: 3rem;\r\n      color: #9ca3af;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .empty-state-avatar svg {\r\n      color: #6b7280;\r\n    }\r\n\r\n    .empty-state-content {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 0.5rem;\r\n    }\r\n\r\n    .empty-state-message {\r\n      font-size: 1.25rem;\r\n      font-weight: 600;\r\n      margin: 0;\r\n      color: #374151;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .empty-state-message {\r\n      color: #f3f4f6;\r\n    }\r\n\r\n    .empty-state-subtitle {\r\n      font-size: 0.9375rem;\r\n      margin: 0;\r\n      color: #6b7280;\r\n      max-width: 24rem;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .empty-state-subtitle {\r\n      color: #9ca3af;\r\n    }\r\n\r\n    .message {\r\n      display: flex;\r\n      gap: 1rem;\r\n    }\r\n\r\n    .message.user {\r\n      flex-direction: row-reverse;\r\n    }\r\n\r\n    .avatar {\r\n      width: 2.5rem;\r\n      height: 2.5rem;\r\n      border-radius: 9999px;\r\n      background: #E5E7EB;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      flex-shrink: 0;\r\n      font-weight: 600;\r\n      font-size: 0.875rem;\r\n      overflow: hidden;\r\n      color: #6B7280;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .avatar {\r\n      background: #3f3f46;\r\n      color: #9ca3af;\r\n    }\r\n\r\n    .avatar-image {\r\n      width: 100%;\r\n      height: 100%;\r\n      object-fit: cover;\r\n    }\r\n\r\n    .message-content {\r\n      max-width: 36rem;\r\n      padding: 0.875rem 1.125rem;\r\n      border-radius: 1.25rem;\r\n      line-height: 1.6;\r\n    }\r\n\r\n    .message.user .message-content {\r\n      background: var(--user-message-bg, #D6E4FF);\r\n      color: #1a1a1a;\r\n      border-radius: 1.25rem 1.25rem 0.25rem 1.25rem;\r\n    }\r\n\r\n    .message.assistant .message-content {\r\n      background: var(--bot-message-bg, #F5F5F5);\r\n      color: #1a1a1a;\r\n      border-radius: 1.25rem 1.25rem 1.25rem 0.25rem;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .message.user .message-content {\r\n      background: #3D5A99;\r\n      color: #fff;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .message.assistant .message-content {\r\n      background: #27272a;\r\n      color: #fafafa;\r\n    }\r\n\r\n    .message-text {\r\n      white-space: pre-wrap;\r\n      margin: 0;\r\n      word-wrap: break-word;\r\n    }\r\n\r\n    .message-text ul,\r\n    .message-text ol {\r\n      margin: 0.5rem 0;\r\n      padding-left: 1.5rem;\r\n      white-space: normal;\r\n    }\r\n\r\n    .message-text li {\r\n      margin: 0.25rem 0;\r\n      white-space: normal;\r\n    }\r\n\r\n    .message-text ul {\r\n      list-style-type: disc;\r\n    }\r\n\r\n    .message-text ol {\r\n      list-style-type: decimal;\r\n    }\r\n\r\n    .faq-section {\r\n      margin-top: 0.75rem;\r\n      padding-top: 0.75rem;\r\n      border-top: 1px solid #d1d5db;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .faq-section {\r\n      border-top-color: #3f3f46;\r\n    }\r\n\r\n    .faq-title {\r\n      font-size: 0.875rem;\r\n      font-weight: 600;\r\n      color: var(--primary-color, #3681D3);\r\n      margin: 0 0 0.375rem 0;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .faq-title {\r\n      color: var(--primary-color-light, #5B7FE8);\r\n    }\r\n\r\n    .faq-list {\r\n      list-style: none;\r\n      padding: 0;\r\n      margin: 0;\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 0.375rem;\r\n    }\r\n\r\n    .faq-item {\r\n      font-size: 0.875rem;\r\n      color: var(--primary-color, #3681D3);\r\n      padding: 0;\r\n      border-radius: 0.5rem;\r\n      cursor: pointer;\r\n      transition: background-color 0.2s, color 0.2s;\r\n      border: 1px solid transparent;\r\n    }\r\n\r\n    .faq-item:hover {\r\n      background-color: #EEF2FF;\r\n      color: var(--primary-color-hover, #3457C7);\r\n      border-color: #C7D2FE;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .faq-item {\r\n      color: var(--primary-color-light, #5B7FE8);\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .faq-item:hover {\r\n      background-color: #1e293b;\r\n      color: #93C5FD;\r\n      border-color: #3f3f46;\r\n    }\r\n\r\n    /* FAQ static item styles - commented out for now */\r\n    /* .faq-item-static {\r\n      font-size: 0.875rem;\r\n      color: #6B7280;\r\n      padding: 0;\r\n      border-radius: 0.5rem;\r\n      cursor: default;\r\n      border: 1px solid transparent;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .faq-item-static {\r\n      color: #9CA3AF;\r\n    } */\r\n\r\n    .loading {\r\n      display: flex;\r\n      gap: 1rem;\r\n    }\r\n\r\n    .spinner {\r\n      display: inline-block;\r\n      width: 1.25rem;\r\n      height: 1.25rem;\r\n      border: 2px solid #e4e4e7;\r\n      border-top-color: #71717a;\r\n      border-radius: 50%;\r\n      animation: spin 1s linear infinite;\r\n    }\r\n\r\n    @keyframes spin {\r\n      to { transform: rotate(360deg); }\r\n    }\r\n\r\n    .input-area {\r\n      border-top: 1px solid #e5e7eb;\r\n      background: #fff;\r\n      padding: 1rem 1.25rem;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .input-area {\r\n      border-top-color: #27272a;\r\n      background: #18181b;\r\n    }\r\n\r\n    .input-form {\r\n      max-width: 56rem;\r\n      margin: 0 auto;\r\n      display: flex;\r\n      gap: 0.75rem;\r\n      align-items: center;\r\n    }\r\n\r\n    .input-field {\r\n      flex: 1;\r\n      height: 3rem;\r\n      padding: 0 1rem;\r\n      border: 1px solid #d1d5db;\r\n      border-radius: 1.5rem;\r\n      font-size: 0.9375rem;\r\n      font-family: inherit;\r\n      background: #fff;\r\n      color: #374151;\r\n      transition: border-color 0.2s, box-shadow 0.2s;\r\n    }\r\n\r\n    .input-field::placeholder {\r\n      color: #9ca3af;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .input-field {\r\n      border-color: #3f3f46;\r\n      background: #18181b;\r\n      color: #fafafa;\r\n    }\r\n\r\n    .input-field:focus {\r\n      outline: none;\r\n      border-color: var(--primary-color, #3681D3);\r\n      box-shadow: 0 0 0 3px rgba(65, 105, 225, 0.1);\r\n    }\r\n\r\n    .input-field:disabled {\r\n      opacity: 0.5;\r\n      cursor: not-allowed;\r\n    }\r\n\r\n    .send-button {\r\n      width: 3rem;\r\n      height: 3rem;\r\n      border-radius: 9999px;\r\n      border: none;\r\n      background: var(--primary-color, #3681D3);\r\n      color: #fff;\r\n      cursor: pointer;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      transition: background 0.2s, transform 0.1s;\r\n      flex-shrink: 0;\r\n    }\r\n\r\n    .send-button:hover:not(:disabled) {\r\n      background: var(--primary-color-hover, #3457C7);\r\n      transform: scale(1.05);\r\n    }\r\n\r\n    .send-button:active:not(:disabled) {\r\n      transform: scale(0.95);\r\n    }\r\n\r\n    .send-button:disabled {\r\n      opacity: 0.5;\r\n      cursor: not-allowed;\r\n    }\r\n\r\n    .send-icon {\r\n      width: 1.25rem;\r\n      height: 1.25rem;\r\n    }\r\n\r\n    .version-tag {\r\n      text-align: center;\r\n      padding: 0.5rem;\r\n      font-size: 0.75rem;\r\n      color: #9ca3af;\r\n      border-top: 1px solid #e5e7eb;\r\n    }\r\n\r\n    :host([theme=\"dark\"]) .version-tag {\r\n      color: #6b7280;\r\n      border-top-color: #27272a;\r\n    }\r\n  `;\r\n\r\n  declare apiUrl: string;\r\n  declare sessionId: string;\r\n  declare chatTitle: string;\r\n  declare theme: 'light' | 'dark';\r\n  declare mode: 'fullscreen' | 'widget';\r\n  declare initialMessages: Message[];\r\n  declare botAvatarUrl: string;\r\n  declare backgroundImageUrl: string;\r\n  declare widgetWidth: string;\r\n  declare widgetHeight: string;\r\n  declare primaryColor: string;\r\n  declare primaryColorHover: string;\r\n  declare userMessageBg: string;\r\n  declare botMessageBg: string;\r\n  declare welcomeMessage: string;\r\n  declare welcomeSubtitle: string;\r\n\r\n  @state()\r\n  private declare messages: Message[];\r\n\r\n  @state()\r\n  private declare input: string;\r\n\r\n  @state()\r\n  private declare isLoading: boolean;\r\n\r\n  @state()\r\n  private declare isOpen: boolean;\r\n\r\n  private messagesEndRef?: HTMLDivElement;\r\n\r\n  static override properties = {\r\n    apiUrl: { type: String, attribute: 'api-url' },\r\n    sessionId: { type: String, attribute: 'session-id' },\r\n    chatTitle: { type: String, attribute: 'title' },\r\n    theme: { type: String },\r\n    mode: { type: String, reflect: true },\r\n    initialMessages: { type: Array },\r\n    botAvatarUrl: { type: String, attribute: 'bot-avatar-url' },\r\n    backgroundImageUrl: { type: String, attribute: 'background-image-url' },\r\n    widgetWidth: { type: String, attribute: 'widget-width' },\r\n    widgetHeight: { type: String, attribute: 'widget-height' },\r\n    primaryColor: { type: String, attribute: 'primary-color' },\r\n    primaryColorHover: { type: String, attribute: 'primary-color-hover' },\r\n    userMessageBg: { type: String, attribute: 'user-message-bg' },\r\n    botMessageBg: { type: String, attribute: 'bot-message-bg' },\r\n    welcomeMessage: { type: String, attribute: 'welcome-message' },\r\n    welcomeSubtitle: { type: String, attribute: 'welcome-subtitle' },\r\n  };\r\n\r\n  constructor() {\r\n    super();\r\n    this.apiUrl = '';\r\n    this.sessionId = 'default-session';\r\n    this.chatTitle = 'My AI Agent';\r\n    this.theme = 'light';\r\n    this.mode = 'fullscreen';\r\n    this.initialMessages = [];\r\n    this.botAvatarUrl = '';\r\n    this.backgroundImageUrl = '';\r\n    this.widgetWidth = '380px';\r\n    this.widgetHeight = '600px';\r\n    this.primaryColor = '#3681D3';\r\n    this.primaryColorHover = '#3457C7';\r\n    this.userMessageBg = '#D6E4FF';\r\n    this.botMessageBg = '#F5F5F5';\r\n    this.welcomeMessage = 'How can I help you today?';\r\n    this.welcomeSubtitle = '';\r\n    this.messages = [];\r\n    this.input = '';\r\n    this.isLoading = false;\r\n    this.isOpen = false;\r\n  }\r\n\r\n  private toggleWidget() {\r\n    this.isOpen = !this.isOpen;\r\n  }\r\n\r\n  private lightenColor(hex: string, percent: number = 15): string {\r\n    // Remove # if present\r\n    hex = hex.replace('#', '');\r\n\r\n    // Convert to RGB\r\n    const r = parseInt(hex.substring(0, 2), 16);\r\n    const g = parseInt(hex.substring(2, 4), 16);\r\n    const b = parseInt(hex.substring(4, 6), 16);\r\n\r\n    // Lighten\r\n    const newR = Math.min(255, Math.round(r + (255 - r) * (percent / 100)));\r\n    const newG = Math.min(255, Math.round(g + (255 - g) * (percent / 100)));\r\n    const newB = Math.min(255, Math.round(b + (255 - b) * (percent / 100)));\r\n\r\n    // Convert back to hex\r\n    return `#${newR.toString(16).padStart(2, '0')}${newG.toString(16).padStart(2, '0')}${newB.toString(16).padStart(2, '0')}`;\r\n  }\r\n\r\n  private formatMessageContent(content: string): string {\r\n    // Escape HTML to prevent XSS\r\n    const escapeHtml = (text: string) => {\r\n      const div = document.createElement('div');\r\n      div.textContent = text;\r\n      return div.innerHTML;\r\n    };\r\n\r\n    // First, split inline numbered lists (1. 2. 3. pattern)\r\n    let processedContent = content.replace(/(\\d+\\.\\s+[^0-9]+?)(?=\\s+\\d+\\.\\s+|\\s*$)/g, '$1\\n');\r\n\r\n    // Split inline bullet lists (- pattern)\r\n    processedContent = processedContent.replace(/(-\\s+[^-]+?)(?=\\s+-\\s+|\\s*$)/g, '$1\\n');\r\n\r\n    // Split content by lines\r\n    const lines = processedContent.split('\\n');\r\n    let formattedContent = '';\r\n    let inList = false;\r\n    let listType: 'ul' | 'ol' | null = null;\r\n\r\n    for (let i = 0; i < lines.length; i++) {\r\n      const line = lines[i];\r\n      const trimmedLine = line.trim();\r\n\r\n      // Check for unordered list (-, *, ‚Ä¢)\r\n      const unorderedMatch = trimmedLine.match(/^[-*‚Ä¢]\\s+(.+)$/);\r\n      // Check for ordered list (1., 2., etc.)\r\n      const orderedMatch = trimmedLine.match(/^\\d+\\.\\s+(.+)$/);\r\n\r\n      if (unorderedMatch) {\r\n        if (!inList || listType !== 'ul') {\r\n          if (inList) formattedContent += listType === 'ol' ? '</ol>' : '</ul>';\r\n          formattedContent += '<ul>';\r\n          inList = true;\r\n          listType = 'ul';\r\n        }\r\n        formattedContent += `<li>${escapeHtml(unorderedMatch[1])}</li>`;\r\n      } else if (orderedMatch) {\r\n        if (!inList || listType !== 'ol') {\r\n          if (inList) formattedContent += listType === 'ol' ? '</ol>' : '</ul>';\r\n          formattedContent += '<ol>';\r\n          inList = true;\r\n          listType = 'ol';\r\n        }\r\n        formattedContent += `<li>${escapeHtml(orderedMatch[1])}</li>`;\r\n      } else {\r\n        // Not a list item\r\n        if (inList) {\r\n          formattedContent += listType === 'ol' ? '</ol>' : '</ul>';\r\n          inList = false;\r\n          listType = null;\r\n        }\r\n        // Add regular line\r\n        if (trimmedLine === '') {\r\n          formattedContent += '<br>';\r\n        } else {\r\n          formattedContent += escapeHtml(line) + '\\n';\r\n        }\r\n      }\r\n    }\r\n\r\n    // Close any open list\r\n    if (inList) {\r\n      formattedContent += listType === 'ol' ? '</ol>' : '</ul>';\r\n    }\r\n\r\n    return formattedContent;\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    if (this.initialMessages && this.initialMessages.length > 0) {\r\n      this.messages = [...this.initialMessages];\r\n    } else if (this.welcomeMessage) {\r\n      // Add welcome message as initial assistant message\r\n      const welcomeText = this.welcomeSubtitle\r\n        ? `${this.welcomeMessage}\\n\\n${this.welcomeSubtitle}`\r\n        : this.welcomeMessage;\r\n\r\n      this.messages = [{\r\n        id: 'welcome-' + Date.now(),\r\n        role: 'assistant',\r\n        content: welcomeText,\r\n      }];\r\n    }\r\n  }\r\n\r\n  updated(changedProperties: PropertyValues) {\r\n    super.updated(changedProperties);\r\n    if (changedProperties.has('messages')) {\r\n      this.scrollToBottom();\r\n    }\r\n  }\r\n\r\n  private scrollToBottom() {\r\n    requestAnimationFrame(() => {\r\n      this.messagesEndRef?.scrollIntoView({ behavior: 'smooth' });\r\n    });\r\n  }\r\n\r\n  private handleInput(e: Event) {\r\n    this.input = (e.target as HTMLInputElement).value;\r\n  }\r\n\r\n  private handleFAQClick(question: string) {\r\n    if (this.isLoading) return;\r\n\r\n    // Set the input and trigger submit\r\n    this.input = question;\r\n\r\n    // Create a synthetic submit event\r\n    const submitEvent = new Event('submit', { cancelable: true });\r\n    this.handleSubmit(submitEvent);\r\n  }\r\n\r\n  private async handleSubmit(e: Event) {\r\n    e.preventDefault();\r\n\r\n    if (!this.input.trim() || this.isLoading || !this.apiUrl) return;\r\n\r\n    const userMessage: Message = {\r\n      id: Date.now().toString(),\r\n      role: 'user',\r\n      content: this.input.trim(),\r\n    };\r\n\r\n    this.messages = [...this.messages, userMessage];\r\n    const questionText = this.input.trim();\r\n    this.input = '';\r\n    this.isLoading = true;\r\n\r\n    // Dispatch message-sent event\r\n    this.dispatchEvent(new CustomEvent('message-sent', {\r\n      detail: userMessage,\r\n      bubbles: true,\r\n      composed: true,\r\n    }));\r\n\r\n    try {\r\n      const response = await fetch(`${this.apiUrl}/ask`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          session_id: this.sessionId,\r\n          question: questionText,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorText = await response.text();\r\n        throw new Error(`Backend error: ${response.status} ${errorText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      console.log('üîç Raw API response:', data);\r\n\r\n      // Extract the response text and suggested questions\r\n      let responseText = 'No response from agent';\r\n      // let faqs: FAQ[] | undefined = undefined;  // Commented out - FAQ functionality disabled\r\n      let suggestedQuestions: string[] | undefined = undefined;\r\n\r\n      if (data && typeof data === 'object' && data.response && typeof data.response === 'string') {\r\n        console.log('üìù data.response type:', typeof data.response);\r\n        console.log('üìù data.response preview:', data.response.substring(0, 100));\r\n\r\n        // Check if data.response contains stringified JSON\r\n        const trimmedResponse = data.response.trim();\r\n        if (trimmedResponse.startsWith('{') || trimmedResponse.startsWith('[')) {\r\n          console.log('üîÑ Detected stringified JSON, parsing...');\r\n\r\n          try {\r\n            // First attempt: standard JSON.parse\r\n            let innerData = JSON.parse(data.response);\r\n            console.log('‚úÖ Parsed inner data with JSON.parse');\r\n\r\n            if (innerData && innerData.response && typeof innerData.response === 'string') {\r\n              responseText = innerData.response;\r\n              // faqs = innerData.faq_used || innerData.faqs_used || undefined;  // Commented out - FAQ functionality disabled\r\n              suggestedQuestions = innerData.suggested_follow_ups || innerData.suggested_questions || undefined;\r\n              console.log('‚úÖ Extracted text length:', responseText.length);\r\n              // console.log('‚úÖ Extracted FAQs count:', faqs?.length || 0);  // Commented out - FAQ functionality disabled\r\n              console.log('‚úÖ Extracted suggested questions count:', suggestedQuestions?.length || 0);\r\n            } else {\r\n              responseText = data.response;\r\n              // faqs = data.faq_used || data.faqs_used || undefined;  // Commented out - FAQ functionality disabled\r\n              suggestedQuestions = data.suggested_follow_ups || data.suggested_questions || undefined;\r\n            }\r\n          } catch (parseError) {\r\n            console.warn('‚ö†Ô∏è JSON.parse failed, using regex extraction...', parseError);\r\n\r\n            // Backend has malformed JSON - extract response text\r\n            const responsePattern = /\"response\"\\s*:\\s*\"([^\"]*(?:\\\\.[^\"]*)*)\"/s;\r\n            const responseMatch = data.response.match(responsePattern);\r\n\r\n            if (responseMatch) {\r\n              responseText = responseMatch[1]\r\n                .replace(/\\\\n/g, '\\n')\r\n                .replace(/\\\\t/g, '\\t')\r\n                .replace(/\\\\r/g, '\\r')\r\n                .replace(/\\\\\"/g, '\"')\r\n                .replace(/\\\\\\\\/g, '\\\\');\r\n              console.log('‚úÖ Extracted response text, length:', responseText.length);\r\n            } else {\r\n              console.error('‚ùå Could not extract response');\r\n              responseText = 'Error: Could not parse response';\r\n            }\r\n\r\n            // FAQ extraction - commented out for now\r\n            // // Extract FAQs array (support both faq_used and faqs_used)\r\n            // const faqsPattern = /\"(?:faq_used|faqs_used)\"\\s*:\\s*(\\[[^\\]]*\\])/s;\r\n            // const faqsMatch = data.response.match(faqsPattern);\r\n            //\r\n            // if (faqsMatch) {\r\n            //   try {\r\n            //     faqs = JSON.parse(faqsMatch[1]);\r\n            //     console.log('‚úÖ Extracted FAQs, count:', faqs?.length || 0);\r\n            //   } catch {\r\n            //     console.log('‚ö†Ô∏è Could not parse FAQs, trying multiline...');\r\n            //     // FAQs might span multiple lines\r\n            //     const faqsMultiPattern = /\"(?:faq_used|faqs_used)\"\\s*:\\s*(\\[[\\s\\S]*?\\n\\s*\\])/;\r\n            //     const faqsMultiMatch = data.response.match(faqsMultiPattern);\r\n            //     if (faqsMultiMatch) {\r\n            //       try {\r\n            //         faqs = JSON.parse(faqsMultiMatch[1]);\r\n            //         console.log('‚úÖ Extracted multi-line FAQs, count:', faqs?.length || 0);\r\n            //       } catch {\r\n            //         faqs = undefined;\r\n            //       }\r\n            //     }\r\n            //   }\r\n            // }\r\n\r\n            // Extract suggested questions array\r\n            const suggestedPattern = /\"(?:suggested_follow_ups|suggested_questions)\"\\s*:\\s*(\\[[^\\]]*\\])/s;\r\n            const suggestedMatch = data.response.match(suggestedPattern);\r\n\r\n            if (suggestedMatch) {\r\n              try {\r\n                suggestedQuestions = JSON.parse(suggestedMatch[1]);\r\n                console.log('‚úÖ Extracted suggested questions, count:', suggestedQuestions?.length || 0);\r\n              } catch {\r\n                console.log('‚ö†Ô∏è Could not parse suggested questions, trying multiline...');\r\n                const suggestedMultiPattern = /\"(?:suggested_follow_ups|suggested_questions)\"\\s*:\\s*(\\[[\\s\\S]*?\\n\\s*\\])/;\r\n                const suggestedMultiMatch = data.response.match(suggestedMultiPattern);\r\n                if (suggestedMultiMatch) {\r\n                  try {\r\n                    suggestedQuestions = JSON.parse(suggestedMultiMatch[1]);\r\n                    console.log('‚úÖ Extracted multi-line suggested questions, count:', suggestedQuestions?.length || 0);\r\n                  } catch {\r\n                    suggestedQuestions = undefined;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          // Not JSON, direct text response\r\n          console.log('üìÑ Direct text response (not JSON)');\r\n          responseText = data.response;\r\n          // faqs = data.faq_used || data.faqs_used || undefined;  // Commented out - FAQ functionality disabled\r\n          suggestedQuestions = data.suggested_follow_ups || data.suggested_questions || undefined;\r\n        }\r\n      } else if (typeof data === 'string') {\r\n        console.log('üìÑ Response is a plain string');\r\n        responseText = data;\r\n      } else if (data && typeof data === 'object') {\r\n        // Fallback for other formats\r\n        console.warn('‚ö†Ô∏è Unexpected format, using fallback');\r\n        responseText = data.message || data.answer || 'Error: Unexpected response format';\r\n        // faqs = data.faq_used || data.faqs_used || undefined;  // Commented out - FAQ functionality disabled\r\n        suggestedQuestions = data.suggested_follow_ups || data.suggested_questions || undefined;\r\n      }\r\n\r\n      console.log('üéØ Final responseText length:', responseText.length);\r\n      console.log('üéØ Final responseText preview:', responseText.substring(0, 100));\r\n      // console.log('üéØ Final FAQs:', faqs);  // Commented out - FAQ functionality disabled\r\n      console.log('üéØ Final suggested questions:', suggestedQuestions);\r\n\r\n      const assistantMessage: Message = {\r\n        id: (Date.now() + 1).toString(),\r\n        role: 'assistant',\r\n        content: responseText,\r\n        // faqs: faqs,  // Commented out - FAQ functionality disabled\r\n        suggestedQuestions: suggestedQuestions,\r\n      };\r\n\r\n      this.messages = [...this.messages, assistantMessage];\r\n\r\n      // Dispatch response-received event\r\n      this.dispatchEvent(new CustomEvent('response-received', {\r\n        detail: assistantMessage,\r\n        bubbles: true,\r\n        composed: true,\r\n      }));\r\n    } catch (err) {\r\n      console.error('Backend connection failed:', err);\r\n\r\n      const errorMessage: Message = {\r\n        id: (Date.now() + 1).toString(),\r\n        role: 'assistant',\r\n        content: `Error: ${err instanceof Error ? err.message : 'Unknown error'}\\n\\nPlease check your API endpoint configuration.`,\r\n      };\r\n\r\n      this.messages = [...this.messages, errorMessage];\r\n\r\n      // Dispatch error event\r\n      this.dispatchEvent(new CustomEvent('error', {\r\n        detail: err,\r\n        bubbles: true,\r\n        composed: true,\r\n      }));\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n\r\n  private renderChatUI() {\r\n    const primaryColorLight = this.lightenColor(this.primaryColor, 15);\r\n\r\n    return html`\r\n      <!-- Header -->\r\n      <div class=\"header\" style=\"--primary-color: ${this.primaryColor}; --primary-color-light: ${primaryColorLight}; --primary-color-hover: ${this.primaryColorHover};\">\r\n        <div class=\"header-content\">\r\n          <div class=\"header-avatar\">\r\n            ${this.botAvatarUrl\r\n              ? html`<img src=\"${this.botAvatarUrl}\" alt=\"Bot\" class=\"header-avatar-image\" />`\r\n              : html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"${this.primaryColor}\" stroke-width=\"2\" style=\"width: 1.5rem; height: 1.5rem;\">\r\n                  <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"></path>\r\n                </svg>`}\r\n          </div>\r\n          <h1 class=\"title\">${this.chatTitle}</h1>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Messages Area -->\r\n      <div class=\"messages-area\" style=\"--user-message-bg: ${this.userMessageBg}; --bot-message-bg: ${this.botMessageBg}; --primary-color: ${this.primaryColor}; --primary-color-light: ${primaryColorLight}; --primary-color-hover: ${this.primaryColorHover}; ${this.backgroundImageUrl ? `--background-image-url: url('${this.backgroundImageUrl}');` : ''}\">\r\n        <div class=\"messages-container\">\r\n          ${repeat(this.messages, (msg) => msg.id, (msg) => html`\r\n            <div class=${classMap({\r\n              message: true,\r\n              user: msg.role === 'user',\r\n              assistant: msg.role === 'assistant'\r\n            })}>\r\n              <div class=\"avatar\">\r\n                ${msg.role === 'user'\r\n                  ? 'U'\r\n                  : this.botAvatarUrl\r\n                    ? html`<img src=\"${this.botAvatarUrl}\" alt=\"AI\" class=\"avatar-image\" />`\r\n                    : 'AI'}\r\n              </div>\r\n              <div class=\"message-content\">\r\n                <div class=\"message-text\">${unsafeHTML(this.formatMessageContent(msg.content))}</div>\r\n                <!-- FAQ section - commented out for now -->\r\n                <!-- ${msg.role === 'assistant' && msg.faqs && msg.faqs.length > 0 ? html`\r\n                  <div class=\"faq-section\">\r\n                    <p class=\"faq-title\">Related FAQs:</p>\r\n                    <ul class=\"faq-list\">\r\n                      ${msg.faqs.map(faq => html`\r\n                        <li class=\"faq-item-static\">\r\n                          ${faq.question}\r\n                        </li>\r\n                      `)}\r\n                    </ul>\r\n                  </div>\r\n                ` : ''} -->\r\n                ${msg.role === 'assistant' && msg.suggestedQuestions && msg.suggestedQuestions.length > 0 ? html`\r\n                  <div class=\"faq-section\">\r\n                    <p class=\"faq-title\">Suggested Questions:</p>\r\n                    <ul class=\"faq-list\">\r\n                      ${msg.suggestedQuestions.map(question => html`\r\n                        <li class=\"faq-item\" @click=${() => this.handleFAQClick(question)}>\r\n                          ${question}\r\n                        </li>\r\n                      `)}\r\n                    </ul>\r\n                  </div>\r\n                ` : ''}\r\n              </div>\r\n            </div>\r\n          `)}\r\n\r\n          ${this.isLoading ? html`\r\n            <div class=\"loading\">\r\n              <div class=\"avatar\">\r\n                ${this.botAvatarUrl\r\n                  ? html`<img src=\"${this.botAvatarUrl}\" alt=\"AI\" class=\"avatar-image\" />`\r\n                  : 'AI'}\r\n              </div>\r\n              <div class=\"message-content\">\r\n                <div class=\"spinner\"></div>\r\n              </div>\r\n            </div>\r\n          ` : ''}\r\n\r\n          <div ${(el: Element) => this.messagesEndRef = el as HTMLDivElement}></div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Input Area -->\r\n      <div class=\"input-area\" style=\"--primary-color: ${this.primaryColor}; --primary-color-hover: ${this.primaryColorHover};\">\r\n        <form class=\"input-form\" @submit=${this.handleSubmit}>\r\n          <input\r\n            type=\"text\"\r\n            class=\"input-field\"\r\n            placeholder=\"Taip mesej anda...\"\r\n            .value=${this.input}\r\n            @input=${this.handleInput}\r\n            ?disabled=${this.isLoading}\r\n          />\r\n          <button\r\n            type=\"submit\"\r\n            class=\"send-button\"\r\n            ?disabled=${this.isLoading || !this.input.trim()}\r\n            aria-label=\"Send message\"\r\n          >\r\n            ${this.isLoading ? html`\r\n              <div class=\"spinner\" style=\"border-color: #fff; border-top-color: transparent;\"></div>\r\n            ` : html`\r\n              <svg class=\"send-icon\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\"></line>\r\n                <polygon points=\"22 2 15 22 11 13 2 9 22 2\"></polygon>\r\n              </svg>\r\n            `}\r\n          </button>\r\n        </form>\r\n      </div>\r\n\r\n      <!-- Version -->\r\n      <div class=\"version-tag\">v${VERSION}</div>\r\n    `;\r\n  }\r\n\r\n  render() {\r\n    const primaryColorLight = this.lightenColor(this.primaryColor, 15);\r\n\r\n    if (this.mode === 'widget') {\r\n      return html`\r\n        <div class=\"widget-container\">\r\n          <!-- Chat Window -->\r\n          <div\r\n            class=${classMap({ 'widget-window': true, 'open': this.isOpen })}\r\n            style=\"--widget-width: ${this.widgetWidth}; --widget-height: ${this.widgetHeight};\"\r\n          >\r\n            ${this.renderChatUI()}\r\n          </div>\r\n\r\n          <!-- Toggle Button -->\r\n          <button\r\n            class=\"widget-button\"\r\n            style=\"--primary-color: ${this.primaryColor}; --primary-color-light: ${primaryColorLight};\"\r\n            @click=${this.toggleWidget}\r\n            aria-label=${this.isOpen ? 'Close chat' : 'Open chat'}\r\n          >\r\n            ${this.isOpen ? html`\r\n              <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\r\n                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\r\n              </svg>\r\n            ` : html`\r\n              <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"></path>\r\n              </svg>\r\n            `}\r\n          </button>\r\n        </div>\r\n      `;\r\n    }\r\n\r\n    // Fullscreen mode\r\n    return this.renderChatUI();\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'ai-chat': AIChat;\r\n  }\r\n}\r\n"]}